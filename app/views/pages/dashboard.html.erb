<h1>Dashboard</h1>
<br>
<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="buyer-tab" data-toggle="tab" href="#buyer" role="tab" aria-controls="home" aria-selected="true">Buyer</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="seller-tab" data-toggle="tab" href="#seller" role="tab" aria-controls="profile" aria-selected="false">Seller</a>
  </li>
</ul>


<div class="tab-content" id="myTabContent">
  <div class="tab-pane fade show active" id="buyer" role="tabpanel" aria-labelledby="buyer-tab">
    <div class="buyer-container">
      <div class="card-profile">
        <h4>Your profile:</h4>
        <img class="card-profile-user" alt="avatar" src="https://kitt.lewagon.com/placeholder/users/cveneziani" />
        <%= @user.email %><br>
        <%= @user.first_name %>
        <%= @user.last_name %><br>
        <%= @user.phone %>
      </div>
      <div class="dash-booking">
        <h4>Your Bookings:</h4>
      <table>
        <tr>
          <th>Departure</th>
          <th>Arrival</th>
          <th>Departure date</th>
          <th>Return date</th>
          <th>Amt. of miles</th>
          <th>Price</th>
          <th>Status</th>
        </tr>
          <% @user.bookings.each do |booking| %>
        <tr>
          <td><%= booking.departure %></td>
          <td><%= booking.arrival %></td>
          <td><%= booking.departure_date %></td>
          <td><%= booking.return_date %></td>
          <td><%= booking.amount_of_miles %></td>
          <td><%= booking.price %>$</td>
          <td><%= booking.status %><br></td>
        </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>

  <div class="tab-pane fade" id="seller" role="tabpanel" aria-labelledby="seller-tab">
    <div class="seller-container">
      <div class="miles-profile-card">
       <!--  <#% if @miles_profile.id == @miles_profile.user.id ? %> -->
        <h4>Miles Profile:</h4>
        <p style="color: black;"><%= @miles_profile.programme %></p>
        <p style="color: black;"><%= @miles_profile.amount %> Miles</p>
        <p style="color: black;">$<%= @miles_profile.price %> /1000 miles</p>
        <button><%= link_to "Edit your Miles", edit_miles_profile_path(@miles_profile.id), class:"submit-btn" %></button>
      </div>
      <div class="buyer-requests">
        <h4>Requests:</h4>

        <% if @user.requests.any? %>
          <% @user.requests.each do |request| %>
            <%= request.confirmed %>
              <%= request.booking.price %>
              <%= request.booking.amount_of_miles %>
              <%= request.booking.departure %>
              <%= request.booking.arrival %>
              <%= request.booking.departure_date %>
              <%= request.booking.return_date %>
              <% if request.confirmed == "pending" %>
                <%= link_to "Accept", accept_booking_path(request), method: :post  %>
                  <% link_to "Decline", decline_booking_path(request), method: :post %>
              <% elsif request.confirmed == "confirmed" %>
              <%= link_to "see full booking", booking_path(request.booking)  %>
              <% end %>
            <% end %>
          <% end %>

      </div>
    </div>
  </div>
</div>







 <!--  <#% @user.bookings.filter { |booking| booking.miles_profile.user == @user }.each do |booking| %>
  <#%= booking.price %>
  <#%= booking.status %>
  <#%= booking.amount_of_miles %>
 <#% end %> -->

