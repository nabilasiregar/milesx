<h1><%= @user.first_name %>'s Dashboard</h1>
<br>
<!-- do not remove lines 4-17, very iportant so bootstrap tabs work -->
<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="home" aria-selected="true">Profile</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="booking-tab" data-toggle="tab" href="#booking" role="tab" aria-controls="booking" aria-selected="false">Booking</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="miles-tab" data-toggle="tab" href="#miles" role="tab" aria-controls="miles" aria-selected="false">Miles</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="request-tab" data-toggle="tab" href="#request" role="tab" aria-controls="request" aria-selected="false">Requests</a>
  </li>
</ul>

<!-- lines 20, 42, 72, 92 must be kept. If you change ID you must make sure it matches the ID from the above nav-item-tabs^^^^ -->
<div class="tab-content" id="myTabContent"> <!-- all dashboard content is enclosed within "tab-content" div -->
  <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
<!-- lines 21-38 correlate to the "profile" tab on dashboard -->
  <div class="card-trip">
  <div class="card-trip-infos">
    <div>
      <p><strong>Full Name: <%= @user.first_name %> <%= @user.last_name %></strong></p>
      <p><strong>Email:<%= @user.email %></strong></p>
      <p><%= cl_image_tag @user.photo %></p>
    </div>
  </div>
</div>
</div>

<!-- lines 41-65 are dealing with the dashboards "booking" tab the. The card used is a bootstrap card-->
  <div class="tab-pane fade" id="booking" role="tabpanel" aria-labelledby="booking-tab">
    <div class="dash-booking">
      <h2>Hello <%= @user.first_name %> here are your Bookings:</h2>
      <div class="card" style="width: 40rem; color: black;">
        <div class="card-header"style="color: white;">
          <strong>Your bookings:</strong>
        </div>
      </div>
        <% @user.bookings.each do |booking| %>
        <div class="booking-card card" style="width: 40rem; color: black;"> <!-- important line must be kept to make cards actually seperated -->

        <ul class="list-group list-group-flush">
          <li class="list-group-item"><strong>Departure:</strong> <%= booking.departure %></li>
          <li class="list-group-item"><strong>Arrival:</strong> <%= booking.arrival %></li>
          <li class="list-group-item"><strong>Departure date:</strong> <%= booking.departure_date %></li>
          <li class="list-group-item"><strong>Return date:</strong> <%= booking.return_date %></li>
          <li class="list-group-item"><strong>Amount of miles:</strong> <%= booking.amount_of_miles %> miles</li>
          <li class="list-group-item"><strong>Price:</strong> $<%= booking.price %></li>
          <li class="list-group-item"><strong>Status:</strong> <%= booking.status %></li>
          <li class="list-group-item">Download Ticket</li>
        </ul>
      </div>
      <% end %>
      </div>

  </div>
<!-- lines 71-86 are dealing with miles tab. (needs CSS) -->
  <div class="tab-pane fade" id="miles" role="tabpanel" aria-labelledby="miles-tab">
    <div class="miles-container">
      <% if @miles_profile %>
      <div class="miles-profile-card">
       <!--  <#% if @miles_profile.id == @miles_profile.user.id ? %> -->
       <h2> <%=@user.first_name %>'s current miles:</h2>
       <div class="miles-profile-info">
        <span><strong>Your program:</strong> <%= @miles_profile.programme %></span>
        <span><strong>Miles remaining:</strong> <%= @miles_profile.amount %> Miles</span>
        <span><strong>Rate:</strong> $<%= @miles_profile.price %>/1000 miles</span><br>
        <%= link_to "Edit", edit_miles_profile_path(@miles_profile.id), class:"edit-miles-btn" %>
        </div>
      </div>
    </div>
  </div>




<!-- lines 91-132 are dealing with the requests tab. (css is in decent shape) -->
  <div class="tab-pane fade" id="request" role="tabpanel" aria-labelledby="request-tab">
    <div class="buyer-requests">
      <h2><%= @user.first_name %>, here are your pending flight requests from other MilesX users:</h2>
      <div class="card" style="width: 40rem; color: black;">
        <div class="card-header"style="color: white;">
          <strong>Requests:</strong>
        </div>
      </div>
          <% if @user.requests.any? %>
          <% @user.requests.each do |request| %>
          <% unless request.nil? %>
          <div class="request-card card" style="width: 40rem; color: black;"> <!-- important line same as the booking comment -->
            <ul class="list-group list-group-flush">
              <li class="list-group-item"><strong>Departure City:</strong> <%= request.booking.departure %></li>
              <li class="list-group-item"><strong>Arrival city:</strong> <%= request.booking.arrival %></li>
              <li class="list-group-item"><strong>Departure date:</strong> <%= request.booking.departure_date %></li>
              <li class="list-group-item"><strong>Return date:</strong> <%= request.booking.return_date %></li>
              <li class="list-group-item"><strong>Amount of miles:</strong> <%= request.booking.amount_of_miles %></li>
              <li class="list-group-item"><strong>Price:</strong> <%= request.booking.price %></li>
              <li class="list-group-item"><strong>Confirmation/See Request:</strong>
              <%= request.confirmed %><br>
              <% if request.confirmed == "pending" %>
                  <%= link_to "Accept", accept_booking_path(request), class: "btn-accept", method: :post  %>
                  <%= link_to "Decline", decline_booking_path(request), class: "btn-decline", method: :post %>
                <% elsif request.confirmed == "confirmed" %>
                  <%= link_to "see full request", booking_path(request.booking), class: 'btn-see-booking' %>
                </li><br>
              <% end %>
            </ul>
          </div>
          <% end %>
          <% end %>
          <% end %>
<!-- Lines 111-116 is a very imoortant iteration and link_to's that are calling methods in the pages controller -->

      <div class="disclaimer">
        <h6>Disclaimer:</h6>
          <p>MilesX<em> relies on total seller cooperation to mke things run smooth. If you wish to be paid out in full, it is your
          obligation as a seller to be trustworthy should you accept a request. Accepted requests that are not finalized may result in
          the suspenion or termination of your seller account.</em></p>
      </div>
    </div>
  </div>
</div>



<!-- DO NOT REMOVE BELOW LINES, FOR SOME REASON IT CRASHES THE ENTIRE DASHBOARD WITHOUT THEM -->
        </div>
        <% end %>
    </div>

<div class="welcome-message">
  <h1>Hello, <%= @user.first_name %>!</h1>
</div>
<!-- do not remove lines 5-18, very important so bootstrap tabs work -->
<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="home" aria-selected="true">Profile</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="booking-tab" data-toggle="tab" href="#booking" role="tab" aria-controls="booking" aria-selected="false">Bookings</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="miles-tab" data-toggle="tab" href="#miles" role="tab" aria-controls="miles" aria-selected="false">Miles Account</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="request-tab" data-toggle="tab" href="#request" role="tab" aria-controls="request" aria-selected="false">Requests</a>
  </li>
</ul>
<!--              end of bootstrap tab ul class             -->
<div class="tab-content" id="myTabContent">
<!-- start of bookings table -->
<div class="tab-pane fade" id="booking" role="tabpanel" aria-labelledby="booking-tab">
  <div class="container">
<!--     this row contains header for booking details -->
    <div class="row">
      <div class="col-sm">
        <h4>From</h4>
      </div>
      <div class="col-sm">
        <h4>To</h4>
      </div>
      <div class="col-sm">
        <h4>Depart Date</h4>
      </div>
      <div class="col-sm">
        <h4>Return Date</h4>
      </div>
      <div class="col-sm">
        <h4>Flight No.</h4>
      </div>
      <div class="col-sm">
        <h4>Booking Status</h4>
      </div>
      <div class="col-sm">
        <h4>Ticket</h4>
      </div>
      <div class="col-sm">
        <h4>Total</h4>
      </div>
    </div>
<!--     this is the end of row that contains header for booking details -->
<!--   this row contains booking details -->
    <div class="">
      <% @user.bookings.each do |booking| %>

          <div class="list-group-item list-group-item-action p-4">

            <div class="row">
              <div class="col-lg-4 align-self-center mb-4 mb-lg-0">
                <div class="d-flex align-items-center mb-3">
                  <h2 class="h5 mb-0">From <%= booking.departure %> to <%= booking.arrival %> </h2><img src="https://d19m59y37dris4.cloudfront.net/directory/1-3/img/avatar/avatar-0.jpg" alt="Jack London" class="avatar avatar-sm avatar-border-white ml-3">
                </div>
                <p class="text-sm text-muted">Double Room</p><span class="badge badge-pill p-2 badge-secondary-light">February 16, 2019 - February 19, 2019</span>
              </div>
              <div class="col-lg-8">
                <div class="row">
                  <div class="col-6 col-md-4 col-lg-3 py-3 mb-3 mb-lg-0">
                    <h6 class="label-heading">Rate type</h6>
                    <p class="text-sm font-weight-bold">Bed &amp; Breakfast</p>
                    <h6 class="label-heading">Nights </h6>
                    <p class="text-sm font-weight-bold mb-0">3</p>
                  </div>
                  <div class="col-6 col-md-4 col-lg-3 py-3">
                    <h6 class="label-heading">Occupancy</h6>
                    <p class="text-sm font-weight-bold">1 pax</p>
                    <h6 class="label-heading">Charge</h6>
                    <p class="text-sm font-weight-bold mb-0">$244.42</p>
                  </div>
                  <div class="col-6 col-md-4 col-lg-3 py-3">
                    <h6 class="label-heading">Booked Date</h6>
                    <p class="text-sm font-weight-bold">February 16, 2019                                        </p>
                    <h6 class="label-heading">Arrival Time</h6>
                    <p class="text-sm font-weight-bold mb-0">Around 4 PM</p>
                  </div>
                  <div class="col-12 col-lg-3 align-self-center"><span class="text-primary text-sm text-uppercase mr-4 mr-lg-0"><i class="fa fa-check fa-fw mr-2"> </i>Booking paid</span><br class="d-none d-lg-block"><span class="text-primary text-sm text-uppercase"><i class="fa fa-check fa-fw mr-2"> </i>Confirmed</span>
                  </div>
                </div>
              </div>
            </div>
          </div>


      <% end %>
    </div>
<!--     end of row that contains bookings details -->
  </div>
</div>
<!-- end of bookings table -->
</div>




        <p><%#= booking.departure_date %#></p>
        <p><%#= booking.return_date %#></p>
        <p>Flight No.</p>
        <p><%#= booking.status %#></p>
        <p>Download Ticket</p>
        <p>$<%#= booking.price %#></p>
      </div>
